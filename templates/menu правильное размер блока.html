<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feliz Wine Bar | Меню</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #121212;
            color: #f0f0f0;
            overflow-x: hidden;
        }
        .font-title { font-family: 'Playfair Display', serif; }
        .bg-brand-gold { background-color: #D4AF37; }
        .text-brand-gold { color: #D4AF37; }
        .bg-brand-dark-teal { background-color: #1a5159; }
        
        .hero-section { position: relative; height: 60vh; min-height: 500px; }
        #hero-video-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: -1; }
        .hero-video { position: absolute; top: 50%; left: 50%; min-width: 100%; min-height: 100%; width: auto; height: auto; transform: translate(-50%, -50%); object-fit: cover; }
        
        .food-drink-toggle { display: flex; justify-content: center; margin-bottom: 1rem; }
        .toggle-btn { padding: 0.5rem 1.5rem; border: none; background: #2a2a2a; color: #f0f0f0; cursor: pointer; font-weight: 600; transition: all 0.3s; }
        .toggle-btn.active { background: #D4AF37; color: white; }
        .toggle-btn:first-child { border-radius: 20px 0 0 20px; }
        .toggle-btn:last-child { border-radius: 0 20px 20px 0; }
        
        .categories-header { position: sticky; top: 64px; z-index: 20; background: #1a1a1a; padding: 0.5rem 0; border-bottom: 1px solid #333; }
        .categories-scroll-container { position: relative; width: 100%; overflow: hidden; }
        .categories-scroll { display: flex; overflow-x: auto; scroll-behavior: smooth; -webkit-overflow-scrolling: touch; scrollbar-width: none; padding: 12px 0; margin: 0 16px; }
        .categories-scroll::-webkit-scrollbar { display: none; }
        
        .category-scroll-item { flex: 0 0 auto; padding: 8px 16px; margin: 0 4px; border-radius: 20px; background-color: #2a2a2a; color: #f0f0f0; font-weight: 500; white-space: nowrap; cursor: pointer; transition: all 0.3s ease; }
        .category-scroll-item.active { background-color: #D4AF37; color: white; }
        
        .scroll-indicator { position: absolute; top: 0; bottom: 0; width: 40px; display: none; align-items: center; justify-content: center; z-index: 10; pointer-events: none; opacity: 0; transition: opacity 0.3s; }
        .scroll-indicator.left { left: 0; background: linear-gradient(90deg, rgba(26,26,26,0.8) 0%, rgba(26,26,26,0) 100%); }
        .scroll-indicator.right { right: 0; background: linear-gradient(270deg, rgba(26,26,26,0.8) 0%, rgba(26,26,26,0) 100%); }
        .categories-scroll-container:hover .scroll-indicator { opacity: 1; }
        .scroll-button { pointer-events: auto; background-color: #D4AF37; color: white; width: 30px; height: 30px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.3s; }
        .scroll-button:hover { background-color: #e8c05e; }

        @keyframes fadeIn { from { opacity: 0; transform: translate(-50%, -40%); } to { opacity: 1; transform: translate(-50%, -50%); } }
        @keyframes fadeOut { from { opacity: 1; transform: translate(-50%, -50%); } to { opacity: 0; transform: translate(-50%, -60%); } }
        .toast { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #D4AF37; color: white; padding: 16px 32px; border-radius: 8px; z-index: 2000; box-shadow: 0 4px 12px rgba(0,0,0,0.3); animation: fadeIn 0.3s forwards; max-width: 80%; text-align: center; font-size: 18px; display: none; }
        .toast.hide { animation: fadeOut 0.3s forwards; }

        #mobile-user-menu { position: fixed; top: 0; right: -280px; width: 280px; height: 100vh; background-color: #1f1f1f; z-index: 1050; transition: right 0.3s ease; padding-top: 70px; box-shadow: -2px 0 15px rgba(0,0,0,0.5); }
        #mobile-user-menu.active { right: 0; }
        #mobile-user-menu-toggle { position: fixed; right: 15px; top: 15px; z-index: 1051; background: #D4AF37; color: white; border: none; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .mobile-user-menu-overlay { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 1049; opacity: 0; pointer-events: none; transition: opacity 0.3s ease; }
        .mobile-user-menu-overlay.active { opacity: 1; pointer-events: all; }
        .mobile-user-menu-item { display: flex; align-items: center; padding: 12px 20px; margin-bottom: 8px; color: white; font-size: 16px; border-radius: 8px; transition: all 0.3s ease; }
        .mobile-user-menu-item:hover { background-color: #D4AF37; }
        .mobile-user-menu-item i { margin-right: 12px; width: 20px; text-align: center; }

        #mobile-cart-btn { position: fixed; right: 15px; bottom: 20px; z-index: 100; background: #D4AF37; color: white; border: none; width: 60px; height: 60px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
        #mobile-cart-count { position: absolute; top: -5px; right: -5px; background: #ef4444; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; }
        
        .main-header { background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); position: fixed; top: 0; left: 0; width: 100%; z-index: 900; }
        .restaurant-name { font-family: 'Playfair Display', serif; font-weight: 700; font-size: 1.75rem; letter-spacing: 0.05em; }
        .restaurant-name span { color: #D4AF37; }
        
        .language-switcher { cursor: pointer; opacity: 0.7; transition: opacity 0.3s; padding: 4px 8px; border-radius: 4px; }
        .language-switcher:hover { opacity: 1; background-color: rgba(255,255,255,0.1); }
        .language-switcher.active { opacity: 1; font-weight: bold; color: #D4AF37; }

        /* === ИЗМЕНЕННЫЕ СТИЛИ ДЛЯ МОДАЛЬНОГО ОКНА === */
        #product-modal-content {
            background-color: #1f1f1f; /* Фон всего модального окна */
            display: flex;
            flex-direction: column; /* Элементы теперь идут друг под другом */
            height: 90vh; 
            max-height: 600px; /* Немного увеличим макс. высоту для нового дизайна */
            border-radius: 1rem; /* Скругляем углы для всего окна */
        }

        #product-modal-image-container {
            height: 60%; /* Фото занимает 60% высоты модального окна */
            position: relative;
            flex-shrink: 0; /* Запрещаем контейнеру сжиматься */
            overflow: hidden; /* Скрываем части изображения, которые могут выйти за скругленные углы */
        }

        /* Это магия для градиента поверх фото */
        #product-modal-image-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 80px; /* Высота градиента */
            background: linear-gradient(to top, #1f1f1f, transparent); /* Плавный переход от фона окна к прозрачному */
            pointer-events: none; /* Градиент не мешает кликать по кнопкам */
        }

        /* Стили для самого изображения, чтобы оно было одинаковым */
        #product-modal-image {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Главное свойство для унификации размера! */
        }

        #product-modal-text-content {
            /* Убираем абсолютное позиционирование */
            color: white;
            padding: 1rem 1.5rem 1.5rem 1.5rem; /* Отступы для текста */
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex-grow: 1; /* Блок с текстом занимает оставшееся место */
        }

        /* Позиционирование кнопок поверх всего */
        #product-modal-buttons {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            padding: 0.75rem;
            display: flex;
            justify-content: space-between;
            z-index: 10;
        }
        
        #product-modal-content.active { transform: translateY(0); }
        
        @media (max-width: 767px) {
            #product-modal-content { 
                height: 85vh;
                max-height: 700px;
                position: fixed; 
                left: 50%;
                top: 50%;
                transform: translate(-50%, -50%);
            }
             #product-modal-content.active {
                transform: translate(-50%, -50%);
            }
        }
        @media (min-width: 768px) {
            .hero-section { height: 80vh; }
            #mobile-user-menu-toggle, #mobile-user-menu, .mobile-user-menu-overlay, #mobile-cart-btn { display: none; }
            .scroll-indicator { display: flex; }
            #product-modal-content {
                position: relative;
                top: auto;
                bottom: auto;
                left: auto;
                transform: none;
                height: 550px; /* Фиксированная высота на ПК */
            }
        }

        /* СТИЛИ ДЛЯ КАРТОЧЕК ТОВАРОВ */
        .product-card-image-wrapper {
            position: relative;
            width: 100%;
            padding-top: 100%;
            overflow: hidden;
            border-radius: 0.5rem;
            background-color: #1a1a1a;
        }
        .product-card-image-wrapper img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0.5rem;
            transition: transform 0.3s ease;
        }
        .product-card-image-wrapper img:hover {
            transform: scale(1.05);
        }
        .product-price-overlay {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            font-size: 0.875rem;
            padding: 4px 12px;
            border-radius: 0.375rem;
            font-weight: 600;
        }
        .product-card-name-wrapper {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem;
            background-color: #2a2a2a;
            border-radius: 0 0 0.5rem 0.5rem;
        }
        .product-card-name {
            font-size: 1rem;
            font-weight: 600;
            color: white;
            flex-grow: 1;
            margin-right: 0.5rem;
        }
        .product-card-add-btn {
            background-color: #1a5159;
            color: white;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            transition: background-color 0.3s ease;
        }
        .product-card-add-btn:hover {
            background-color: #1e606b;
        }
    </style>
</head>
<body class="bg-brand-dark">
    <div id="toast" class="toast"></div>

    <div id="auth-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1100] hidden">
        <div class="bg-[#2a2a2a] rounded-lg p-8 w-full max-w-md relative">
            <button onclick="toggleModal('auth-modal')" class="absolute top-4 right-4 text-gray-400 text-2xl">&times;</button>
            <h2 id="auth-title" class="text-3xl font-bold text-white text-center mb-6" data-translate="login_title">Вход</h2>
    
            <form id="login-form">
                <input type="email" id="login-email" placeholder="Email" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="email_placeholder" required>
                <input type="password" id="login-password" placeholder="Пароль" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-6" data-translate="password_placeholder" required>
                <button type="submit" class="w-full bg-brand-gold text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition" data-translate="login_btn">Войти</button>
            </form>
            <form id="register-form" class="hidden">
                <input type="text" id="reg-name" placeholder="Ваше имя" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="name_placeholder" required>
                <input type="email" id="reg-email" placeholder="Email" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="email_placeholder" required>
                <input type="tel" id="reg-phone" placeholder="Телефон" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="phone_placeholder" required>
                <input type="password" id="reg-password" placeholder="Пароль" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-6" data-translate="password_placeholder" required>
                <button type="submit" class="w-full bg-brand-gold text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition" data-translate="register_btn">Зарегистрироваться</button>
            </form>
            <p class="text-center text-gray-400 mt-6">
                <span id="auth-switch-text" data-translate="no_account">Нет аккаунта?</span> 
                <button onclick="switchAuthMode()" id="auth-switch-button" class="text-brand-gold font-semibold hover:text-amber-600 transition" data-translate="switch_to_register">Регистрация</button>
            </p>
        </div>
    </div>

    <div id="product-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1000] hidden">
        <div id="product-modal-content" class="w-full max-w-md relative mx-auto bottom-0 fixed md:relative transform md:translate-y-0 translate-y-full transition-transform duration-300 ease-in-out overflow-hidden">
            
            <div id="product-modal-image-container">
                <div id="product-modal-buttons">
                    <button onclick="toggleProductModal()" class="bg-black/40 backdrop-blur-sm rounded-lg text-white h-9 w-9 flex items-center justify-center text-lg">
                        <i class="fas fa-times"></i>
                    </button>
                    <button class="bg-black/40 backdrop-blur-sm rounded-lg text-white h-9 w-9 flex items-center justify-center text-lg">
                        <i class="fas fa-share-alt"></i>
                    </button>
                </div>
                <img id="product-modal-image" src="" alt="Product Image" class="w-full h-full object-cover">
            </div>
            <div id="product-modal-text-content">
                <h3 id="product-modal-name" class="text-2xl font-bold mb-1"></h3>
                <p id="product-modal-description" class="text-sm text-gray-300 mb-4 h-10 overflow-y-auto"></p>
                
                <div class="flex justify-between items-center mb-4">
                    <p id="product-modal-price" class="text-2xl font-bold text-brand-gold"></p>
                    <div class="flex items-center bg-[#2a2a2a] rounded-full">
                        <button id="quantity-minus" class="w-10 h-10 text-white text-xl rounded-full hover:bg-gray-700 transition">-</button>
                        <span id="product-modal-quantity" class="w-10 text-center font-bold text-white text-lg">1</span>
                        <button id="quantity-plus" class="w-10 h-10 text-white text-xl rounded-full hover:bg-gray-700 transition">+</button>
                    </div>
                </div>
                
                <button id="modal-add-to-cart-btn" class="w-full bg-brand-gold text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition" data-translate="add_to_cart_btn">Добавить в корзину</button>
            </div>

        </div>
    </div>
    <div id="cart-sidebar" class="fixed top-0 right-0 h-full w-full md:w-96 bg-[#2a2a2a] shadow-2xl z-[1060] transform translate-x-full transition-transform duration-300">
        <div class="p-6 flex flex-col h-full">
            <div class="flex justify-between items-center border-b border-gray-700 pb-4 mb-4">
                <h2 class="text-2xl font-bold text-white" data-translate="cart_title">Корзина</h2>
                <button onclick="toggleCart()" class="text-gray-400 text-3xl hover:text-white transition">&times;</button>
            </div>
            <div id="cart-items" class="flex-grow overflow-y-auto"></div>
            <div class="border-t border-gray-700 pt-4 mt-auto">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-lg" data-translate="cart_total">Итого:</span>
                    <span id="cart-total" class="text-2xl font-bold">0 MDL</span>
                </div>
                <button id="checkout-button" class="w-full bg-brand-gold text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition" data-translate="checkout_btn">Оформить заказ</button>
            </div>
        </div>
    </div>
    
    <div id="checkout-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[1100] hidden">
        <div class="bg-[#1f1f1f] rounded-lg p-6 w-full max-w-md relative mx-auto">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-white" data-translate="checkout_title">Оформление заказа</h2>
                <button onclick="toggleModal('checkout-modal')" class="text-gray-400 text-3xl hover:text-white">&times;</button>
            </div>
            <form id="checkout-form-modal">
                <input type="text" id="checkout-name-modal" value="" placeholder="Ваше имя" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="name_placeholder" required>
                <input type="tel" id="checkout-phone-modal" value="" placeholder="Контактный телефон" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-4" data-translate="phone_placeholder" required>
                <input type="text" id="checkout-address-modal" placeholder="Адрес доставки" class="w-full bg-[#333] border border-gray-600 rounded-lg px-4 py-3 text-white mb-6" data-translate="address_placeholder" required>
                <button type="submit" class="w-full bg-brand-gold text-white font-bold py-3 rounded-lg hover:bg-amber-700 transition" data-translate="confirm_order">Подтвердить заказ</button>
            </form>
        </div>
    </div>

    <button id="mobile-user-menu-toggle" class="md:hidden">
        <i class="fas fa-bars"></i>
    </button>
    <div class="mobile-user-menu-overlay" id="mobile-user-menu-overlay"></div>
    <div id="mobile-user-menu" class="z-[1050]">
        <div class="mobile-menu-content p-4">
            {% if user_info %}
                {% if user_info.is_admin %}
                <a href="/admin/dashboard" class="mobile-user-menu-item">
                    <i class="fas fa-cog"></i>
                    <span data-translate="admin_panel">Админ-панель</span>
                </a>
                {% endif %}
                <a href="/profile" class="mobile-user-menu-item">
                    <i class="fas fa-user"></i>
                    <span data-translate="profile">Профиль</span>
                </a>
                <button id="logout-button-mobile" class="mobile-user-menu-item w-full text-left">
                    <i class="fas fa-sign-out-alt"></i>
                    <span data-translate="logout">Выйти</span>
                </button>
            {% else %}
                <button onclick="toggleModal('auth-modal'); toggleMobileUserMenu();" class="mobile-user-menu-item w-full text-left">
                    <i class="fas fa-sign-in-alt"></i>
                    <span data-translate="login">Войти</span>
                </button>
                <button onclick="switchAuthMode(); toggleModal('auth-modal'); toggleMobileUserMenu();" class="mobile-user-menu-item w-full text-left">
                    <i class="fas fa-user-plus"></i>
                    <span data-translate="register">Регистрация</span>
                </button>
            {% endif %}

            <div class="px-2 py-3 border-t border-b border-gray-700/50 my-2">
                <div class="flex justify-around items-center">
                  <span class="language-switcher" data-lang="ru" onclick="setLanguage('ru'); toggleMobileUserMenu();">RU</span>
                  <span class="language-switcher" data-lang="ro" onclick="setLanguage('ro'); toggleMobileUserMenu();">RO</span>
                  <span class="language-switcher" data-lang="en" onclick="setLanguage('en'); toggleMobileUserMenu();">EN</span>
                </div>
            </div>

            <button onclick="toggleCart(); toggleMobileUserMenu();" class="mobile-user-menu-item w-full text-left">
                <i class="fas fa-shopping-cart"></i>
                <span data-translate="cart">Корзина</span>
            </button>
        </div>
    </div>

    <button id="mobile-cart-btn" class="md:hidden">
        <i class="fas fa-shopping-cart"></i>
        <span id="mobile-cart-count">0</span>
    </button>

    <header class="main-header">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="/" class="restaurant-name text-white">Feliz <span>Wine Bar</span></a>
            <nav class="hidden md:flex space-x-2">
                <span class="language-switcher" data-lang="ru" onclick="setLanguage('ru')">RU</span>
                <span class="language-switcher" data-lang="ro" onclick="setLanguage('ro')">RO</span>
                <span class="language-switcher" data-lang="en" onclick="setLanguage('en')">EN</span>
            </nav>
            <div class="hidden md:flex items-center space-x-4">
                {% if user_info %}
                    {% if user_info.is_admin %}
                        <a href="/admin/dashboard" class="text-yellow-400 font-semibold hover:text-yellow-300 transition" data-translate="admin">Админ</a>
                    {% endif %}
                    <a href="/profile" class="text-white font-semibold hover:text-brand-gold transition" data-translate="profile">Профиль</a>
                    <button id="logout-button" class="text-gray-400 hover:text-white transition" data-translate="logout">Выйти</button>
                {% else %}
                    <button onclick="toggleModal('auth-modal')" class="bg-brand-dark-teal text-white px-5 py-2 rounded-lg font-semibold hover:bg-teal-700 transition" data-translate="login">Войти</button>
                {% endif %}

                <button onclick="toggleCart()" id="cart-button" class="relative bg-brand-gold text-white px-4 py-2 rounded-lg hover:bg-amber-700 transition">
                    <i class="fa-solid fa-cart-shopping"></i>
                    <span id="cart-count" class="absolute -top-2 -right-2 bg-red-600 text-white text-xs h-5 w-5 flex items-center justify-center rounded-full">0</span>
                </button>
            </div>
             <button id="mobile-menu-button" class="md:hidden text-white text-2xl" onclick="toggleMobileUserMenu()">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <main class="pt-20">
        <section class="hero-section relative flex items-center justify-center text-center">
            <div id="hero-video-container">
                <div class="hero-video-fallback"></div>
                <video autoplay loop muted playsinline preload="auto" class="hidden md:block hero-video" id="desktop-video" src="/static/videos/felyz.mp4"></video>
                <video autoplay loop muted playsinline preload="auto" class="block md:hidden hero-video" id="mobile-video" src="/static/videos/felmob.mp4"></video>
            </div>
            <div class="absolute inset-0 bg-black/60"></div>
            <div class="relative z-10 max-w-3xl mx-auto px-4">
                <h1 class="text-5xl md:text-7xl font-bold font-title text-white" data-translate="menu_title">Изысканный Вкус</h1>
                <p class="text-xl md:text-2xl text-gray-200 mt-4" data-translate="menu_subtitle">Лучшие вина и авторская кухня</p>
            </div>
        </section>

        <section class="py-12 bg-[#121212]">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center mb-8 md:mb-12" data-translate="our_menu">Наше Меню</h2>
                
                <div class="food-drink-toggle">
                    <button id="food-btn" class="toggle-btn active" data-translate="food_btn">Еда</button>
                    <button id="drinks-btn" class="toggle-btn" data-translate="drinks_btn">Напитки</button>
                </div>
                
                <div class="categories-header">
                    <div class="categories-scroll-container">
                        <div class="scroll-indicator left">
                            <div class="scroll-button" onclick="scrollCategories(-150)">
                                <i class="fas fa-chevron-left"></i>
                            </div>
                        </div>
                        <div class="categories-scroll" id="mobile-categories-scroll"></div>
                        <div class="scroll-indicator right">
                            <div class="scroll-button" onclick="scrollCategories(150)">
                                <i class="fas fa-chevron-right"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="menu-content" class="w-full"></div>
            </div>
        </section>
    </main>
    
    <footer class="bg-[#1f1f1f] py-8">
        <div class="container mx-auto px-4 text-center text-gray-400">
            <p data-translate="rights">&copy; 2025 Feliz Wine Bar.</p>
        </div>
    </footer>
<script>
    let cart = [], isLoginMode = !0, currentFoodFilter = 1, currentLanguage = localStorage.getItem("language") || "ru", currentProductInModal = null, categoryObserver;
    const translations = {
        ru: {
            menu_title: "Изысканный Вкус", menu_subtitle: "Лучшие вина и авторская кухня", our_menu: "Наше Меню", food_btn: "Еда", drinks_btn: "Напитки", rights: "© 2025 Feliz Wine Bar.", add_to_cart_btn: "Добавить в корзину", cart_title: "Корзина", cart_total: "Итого:", checkout_btn: "Оформить заказ", checkout_title: "Оформление заказа", confirm_order: "Подтвердить заказ", name_placeholder: "Ваше имя", phone_placeholder: "Контактный телефон", address_placeholder: "Адрес доставки", login_title: "Вход", register_title: "Регистрация", email_placeholder: "Email", password_placeholder: "Пароль", login_btn: "Войти", register_btn: "Зарегистрироваться", no_account: "Нет аккаунта?", have_account: "Уже есть аккаунт?", switch_to_register: "Регистрация", switch_to_login: "Вход", admin_panel: "Админ-панель", profile: "Профиль", logout: "Выйти", login: "Войти", register: "Регистрация", cart: "Корзина", admin: "Админ", loading_menu: "Загрузка меню...", empty_menu: "В этой категории пока нет позиций.", loading_error: "Ошибка загрузки меню.", item_added: "добавлен в корзину", item_removed: "Товар удален", empty_cart: "Ваша корзина пуста", order_placed: "Заказ успешно оформлен!",
            categories: { Завтрак: "Завтрак", Закуски: "Закуски", Салаты: "Салаты", Супы: "Супы", "Морепродукты и Рыба": "Морепродукты и Рыба", Паста: "Паста", "Мясные блюда": "Мясные блюда", "Бургеры и другое": "Бургеры и другое", Десерты: "Десерты", Кофе: "Кофе", Чай: "Чай", "Соки и Вода": "Соки и Вода", "Пиво и закуски": "Пиво и закуски", "Безалкогольные коктейли": "Безалкогольные коктейли", "Алкогольные коктейли": "Алкогольные коктейли", Виски: "Виски", Коньяк: "Коньяк", Игристые: "Игристые", "Белые вина": "Белые вина", "Розовые вина": "Розовые вина", "Красные вина": "Красные вина" },
            products: {
                "Clătită cu somon (125 gr.)": "Блинчики с лососем", "Clătită cu piept de pui (200 gr.)": "Блинчик с куриной грудкой", "Ou poșat cu somon și salată": "Яйцо-пашот с лососем и салатом", "Ouă prăjite ,ochiuri cu bacon ,roșii și castraveți": "Яичница с беконом, помидорами и огурцами", "Brânzoaice dulci cu smântînă": "Сладкие сырки со сметаной", "Bruschete cu prosciutto si rucola (150 gr.)": "Брускетта с прошутто и рукколой", "Bruschete cu ficat de pui ,pate (150 gr/80)": "Брускетта с паштетом из куриной печени", "Tartar de somon cu cremă de brînză si pesto (180gr/30)": "Тартар из лосося с сырным кремом и песто", "Tartar de vită(150/30)": "Тартар из говядины", "Spring rolls cu creveți (180/30gr)": "Спринг-роллы с креветками", "Bruschete cu ardei și verdeață (150gr.)": "Брускетта с перцем и зеленью", "Bruschete cu somon si castravete (150gr.)": "Брускетта с лососем и огурцом", "Platou cu cascaval (450 gr.)": "Сырное ассорти", "Platou cu salamuri crud afumate (210gr.)": "Ассорти сырокопченая колбаса", "Platou la vin (400gr)": "Тарелка к вину", "Salată de vinete AL FRESCO": "Баклажан по итальянски", "Salata fermierului cu mozzarella (330 gr.)": 'Салат "Фермерский" с моцареллой', "Salată cu file de curcan cu sos cu nucușoară (350gr)": "Салат с филе индейки в соусе с мускатным орехом", "Salată de vițel cu vânătă delicioasă caramelizată (270gr)": "Салат с телятиной и карамелизированным баклажаном", "Caesar cu pui (300 gr.)": 'Салат "Цезарь" с курицей', "Salată grecească (300 gr.)": "Греческий салат", "Borș roșu ucrainesc cu smântînă,slănină,pîine (400/100gr)": "Украинский борщ со сметаной, салом и хлебом", "Supă cremă de ciuperci (350/30gr)": "Крем-суп из грибов", "Supă cremă de cartof cu praz si creveți (350 gr)": "Крем-суп из картофеля с луком-пореем и креветками", "Zeamă (400gr.)": "Зама", "Ciorbă rădăuțeană (400gr.)": "Рэдэуцкая чорба", "Supă cremă de dovleac cu bacon (400gr)": "Крем-суп из тыквы с беконом", "Soleancă (400gr.)": "Солянка", "Creveți saganaki (350 gr)": 'Креветки "Саганаке"', "Creveți tempura cu cartof dipper fries și sos (6 buc/150/50 gr.)": 'Креветки "Темпура" с картофелем фри и соусом', "Creveți în stil toscan (250gr)": "Креветки в тосканском стиле", "Soute cu creveți și midii în sos (2 pers. 1 kg.)": "Соте из креветок и мидий в соусе (на 2 персоны)", "Platou de fructe de mare în sos alb Dorblu (4-5 pers. 1.5kg)": "Тарелка морепродуктов в белом соусе с дорблю (на 4-5 персон)", "Platou creveți Tempura cu sos (2 pers. 500 gr.)": 'Тарелка креветок "Темпура" с соусом (на 2 персоны)', "Fileu de Șalău cu legume batonette (250 gr.)": 'Филе судака с овощами "батонетт"', "Fileu de Dorado cu legume julien": 'Филе дорадо с овощами "жюльен"', "Somon cu broccoli (250 gr.)": "Лосось с брокколи", "Funchoza Creveți": "Фунчоза с креветками", "Funchoza Pui": "Фунчоза с курицей", "Funchoza Vită": "Фунчоза с говядиной", "Pasta cu midii și creveți (350 gr.)": "Паста с мидиями и креветками", "Tagliatelle cu creveți în sos alb (400 gr.)": "Тальятелле с креветками в белом соусе", "Pasta carbonara (350 gr.)": 'Паста "Карбонара"', "Aripioare de pui K.F.C. (210/30gr)": "Куриные крылышки K.F.C.", "Costițe BBQ cu varză și castravete murat": "Ребрышки BBQ с квашеной капустой и маринованным огурцом", "File de pui în sufleu de cașcaval cu sos de spanac": "Куриное филе в суфле из сыра со шпинатным соусом", "File de Rață Chutney cu mere și muștar (310gr/20gr)": "Утиное филе с чатни из яблок и горчицы", "Frigărui de pui cu salată pe lipie (350gr.)": "Шашлык из курицы с салатом на лепешке", "Piept de pui în stil toscan cu sos alb și ciuperci (300 gr.)": "Куриная грудка в тосканском стиле с белым соусом и грибами", "Frigărui de porc pe lipie (350 gr.)": "Шашлык из свинины на лепешке", "Ciolan de porc cu varză murată și polenta (350 gr.)": "Свиная рулька с квашеной капустой и полентой", "File mignon cu piure cu trufe (340gr)": "Филе миньон с трюфельным пюре", "Obrăjori de vițel cu piure cu trufe (330gr)": "Телячьи щечки с картофельным пюре с трюфелями", "Steak de vită cu cartofi și adjică (350gr.)": "Стейк из говядины с картофелем и аджикой", "Quesadilla cu pui (280/30gr)": "Кесадилья с курицей", "Burger cu carne de vită marmorată, cartofi pai и sos": "Бургер с мраморной говядиной, картофелем фри и соусом", "Burger de pui, cartofi pai и sos": "Бургер с курицей, картофелем фри и соусом", "Nuggets cu cartofi pai (350 gr.)": "Наггетсы с картофелем фри", "Cartofi pai (200 gr.)": "Картофель фри", "Clătită cu banană/fructe de pădure/vișină/ si mascarpone (180 gr.)": "Блинчик с бананом/лесными ягодами/вишней и маскарпоне", "Clătită cu banană și nuttela (150gr)": "Блинчик с бананом и Нутеллой", "Lava-cake de ciocolată (100/30gr)": "Лава-кейк из шоколада", "Înghetată în asortiment (Betty-Ice) (3 bile)": "Мороженое в ассортименте (3 шарика)",
                Espresso: "Эспрессо", "Espresso cu lapte": "Эспрессо с молоком", "Espresso Dublu": "Двойной эспрессо", Americano: "Американо", "Americano cu lapte": "Американо с молоком", Cappuccino: "Капучино", "Caffe latte": "Латте", "Ice latte": "Айс Латте", "Ciocolată cu lapte": "Горячий шоколад", "Ceai Aloe Vera (400 ml)": "Чай Алоэ Вера (400 мл)", "Ceai de cătină (400 ml)": "Облепиховый чай (400 мл)", "Ceai Fructul pasiunii (400ml)": "Чай Маракуйя (400мл)", "Ceai de zmeură": "Малиновый чай", "Ceai în asortiment": "Чай в ассортименте", "Ceai în asortiment infuzie (400 ml)": "Заварной чай в ассортименте (400 мл)", "Fresh de portocală (300ml)": "Апельсиновый фреш", "Coca cola (250 ml)":"Кока-кола (250 мл)", "Coca cola zero (250ml)":"Кока-кола зеро (250мл)", "Sprite (250ml)":"Спрайт (250мл)", "Fanta (250 ml)":"Фанта (250 мл)", "Vita (250 ml)":"Сок Vita (250 мл)", "plată/gazată (330ml)": "Вода без/с газом (330мл)", "plată/gazată (750ml)": "Вода без/с газом (750мл)", "Corona (350 ml)": "Corona (350 мл)", "Grolsh (350 ml)": "Grolsch (350 мл)", "Franziskaner (500 ml) (naturtrub)": "Franziskaner нефильтрованное", Chips: "Чипсы", Alune: "Орешки", "Lemongrass": "Лемонграсс", "Raspberry Lemonade": "Малиновый лимонад", "Apple& Aloe Vera Twist": "Яблоко и Алоэ Вера", "Maracuja lemonade": "Лимонад Маракуйя", "Mojito lemonade": "Мохито безалкогольный", "Aperol Spritz": "Апероль Шприц", "Watermelon & Lychee Spritz": "Арбуз и Личи Шприц", "Grapefruit & Lychee Spritz": "Грейпфрут и Личи Шприц", Margarita: "Маргарита", "Mojito alcoholic": "Мохито", "Chery Flower": "Вишневый цвет", "Jameson (40ml)":"Джеймсон (40мл)", "Jameson (700ml)": "Jameson (бутылка)", "Jack Daniels (40ml)":"Джек Дэниэлс (40мл)", "Jack Daniels (700ml)": "Jack Daniels (бутылка)", "Bardar 5 ani (40ml)":"Bardar 5 лет (40мл)", "Bardar 5 ani (500ml)": "Bardar 5 лет (бутылка)", "Bardar Silver 7 ani (40ml)":"Bardar Silver 7 лет (40мл)", "Bardar Silver 7 ani (500ml)": "Bardar Silver 7 лет (бутылка)", "Bardar Gold 7 ani (40ml)":"Bardar Gold 7 лет (40мл)", "Bardar Gold 7 ani (500ml)": "Bardar Gold 7 лет (бутылка)", "Bardar 10 ani (40ml)":"Bardar 10 лет (40мл)", "Bardar 10 ani (500ml)": "Bardar 10 лет (бутылка)", "Bardar 12 ani (500ml)": "Bardar 12 лет (бутылка)"
            }
        },
        en: {
            menu_title: "Exquisite Taste", menu_subtitle: "The best wines and signature cuisine", our_menu: "Our Menu", food_btn: "Food", drinks_btn: "Drinks", rights: "© 2025 Feliz Wine Bar.", add_to_cart_btn: "Add to cart", cart_title: "Cart", cart_total: "Total:", checkout_btn: "Checkout", checkout_title: "Checkout", confirm_order: "Confirm order", name_placeholder: "Your name", phone_placeholder: "Contact phone", address_placeholder: "Delivery address", login_title: "Login", register_title: "Register", email_placeholder: "Email", password_placeholder: "Password", login_btn: "Login", register_btn: "Register", no_account: "Don't have an account?", have_account: "Already have an account?", switch_to_register: "Register", switch_to_login: "Login", admin_panel: "Admin Panel", profile: "Profile", logout: "Logout", login: "Login", register: "Register", cart: "Cart", admin: "Admin", loading_menu: "Loading menu...", empty_menu: "There are no items in this category yet.", loading_error: "Error loading menu.", item_added: "added to cart", item_removed: "Item removed", empty_cart: "Your cart is empty", order_placed: "Order placed successfully!",
            categories: { Завтрак: "Breakfast", Закуски: "Appetizers", Салаты: "Salads", Супы: "Soups", "Морепродукты и Рыба": "Seafood & Fish", Паста: "Pasta", "Мясные блюда": "Meat Dishes", "Бургеры и другое": "Burgers & More", Десерты: "Desserts", Кофе: "Coffee", Чай: "Tea", "Соки и Вода": "Juices & Water", "Пиво и закуски": "Beer & Snacks", "Безалкогольные коктейли": "Non-alcoholic cocktails", "Алкогольные коктейли": "Alcoholic cocktails", Виски: "Whisky", Коньяк: "Divin", Игристые: "Sparkling", "Белые вина": "White Wines", "Розовые вина": "Rosé Wines", "Красные вина": "Red Wines" },
            products: {
                "Clătită cu somon (125 gr.)": "Pancake with salmon", "Clătită cu piept de pui (200 gr.)": "Pancake with chicken breast", "Ou poșat cu somon și salată": "Poached egg with salmon and salad", "Ouă prăjite ,ochiuri cu bacon ,roșii și castraveți": "Fried eggs with bacon, tomatoes and cucumbers", "Brânzoaice dulci cu smântînă": "Cottage cheese pancakes", "Bruschete cu prosciutto si rucola (150 gr.)": "Bruschetta with prosciutto and arugula", "Bruschete cu ficat de pui ,pate (150 gr/80)": "Bruschetta with chicken liver pâté", "Tartar de somon cu cremă de brînză si pesto (180gr/30)": "Salmon tartare with cream cheese and pesto", "Tartar de vită(150/30)": "Beef tartare", "Spring rolls cu creveți (180/30gr)": "Spring rolls with shrimp", "Bruschete cu ardei și verdeață (150gr.)": "Bruschetta with peppers and greens", "Bruschete cu somon si castravete (150gr.)": "Bruschetta with salmon and cucumber", "Platou cu cascaval (450 gr.)": "Cheese platter", "Platou cu salamuri crud afumate (210gr.)": "Cold cuts platter", "Platou la vin (400gr)": "Wine platter", "Salată de vinete AL FRESCO": "Italian Eggplant Salad", "Salata fermierului cu mozzarella (330 gr.)": "Farmer's salad with mozzarella", "Salată cu file de curcan cu sos cu nucușoară (350gr)": "Salad with turkey fillet and nutmeg sauce", "Salată de vițel cu vânătă delicioasă caramelizată (270gr)": "Veal salad with delicious caramelized eggplant", "Caesar cu pui (300 gr.)": "Caesar salad with chicken", "Salată grecească (300 gr.)": "Greek salad", "Borș roșu ucrainesc cu smântînă,slănină,pîine (400/100gr)": "Ukrainian borsch with sour cream, bacon and bread", "Supă cremă de ciuperci (350/30gr)": "Cream of mushroom soup", "Supă cremă de cartof cu praz si creveți (350 gr)": "Cream of potato soup with leek and shrimp", "Zeamă (400gr.)": 'Moldavian soup "Zama"', "Ciorbă rădăuțeană (400gr.)": 'Romanian soup "Ciorba"', "Supă cremă de dovleac cu bacon (400gr)": "Cream of pumpkin soup with bacon", "Soleancă (400gr.)": "Solyanka", "Creveți saganaki (350 gr)": "Saganaki shrimp", "Creveți tempura cu cartof dipper fries și sos (6 buc/150/50 gr.)": "Tempura shrimp with dipper fries and sauce", "Creveți în stil toscan (250gr)": "Tuscan-style shrimp", "Soute cu creveți și midii în sos (2 pers. 1 kg.)": "Sauté of shrimp and mussels in sauce (for 2)", "Platou de fructe de mare în sos alb Dorblu (4-5 pers. 1.5kg)": "Seafood platter in Dorblu white sauce (for 4-5)", "Platou creveți Tempura cu sos (2 pers. 500 gr.)": "Tempura shrimp platter with sauce (for 2)", "Fileu de Șalău cu legume batonette (250 gr.)": 'Pike-perch fillet with "batonette" vegetables', "Fileu de Dorado cu legume julien": 'Dorado fillet with "julien" vegetables', "Somon cu broccoli (250 gr.)": "Salmon with broccoli", "Funchoza Creveți": "Funchoza with shrimp", "Funchoza Pui": "Funchoza with chicken", "Funchoza Vită": "Funchoza with beef", "Pasta cu midii și creveți (350 gr.)": "Pasta with mussels and shrimp", "Tagliatelle cu creveți în sos alb (400 gr.)": "Tagliatelle with shrimp in white sauce", "Pasta carbonara (350 gr.)": "Pasta carbonara", "Aripioare de pui K.F.C. (210/30gr)": "K.F.C. chicken wings", "Costițe BBQ cu varză și castravete murat": "BBQ ribs with sauerkraut and pickled cucumber", "File de pui în sufleu de cașcaval cu sos de spanac": "Chicken fillet in cheese soufflé with spinach sauce", "File de Rață Chutney cu mere și muștar (310gr/20gr)": "Duck fillet with apple and mustard chutney", "Frigărui de pui cu salată pe lipie (350gr.)": "Chicken skewers with salad on flatbread", "Piept de pui în stil toscan cu sos alb și ciuperci (300 gr.)": "Tuscan-style chicken breast with white sauce and mushrooms", "Frigărui de porc pe lipie (350 gr.)": "Pork skewers on flatbread", "Ciolan de porc cu varză murată și polenta (350 gr.)": "Pork knuckle with sauerkraut and polenta", "File mignon cu piure cu trufe (340gr)": "Filet mignon with truffle purée", "Obrăjori de vițel cu piure cu trufe (330gr)": "Veal cheeks with truffle puree", "Steak de vită cu cartofi și adjică (350gr.)": "Beef steak with potatoes and adjika", "Quesadilla cu pui (280/30gr)": "Quesadilla with chicken", "Burger cu carne de vită marmorată, cartofi pai и sos": "Marbled beef burger with fries and sauce", "Burger de pui, cartofi pai и sos": "Chicken burger with fries and sauce", "Nuggets cu cartofi pai (350 gr.)": "Nuggets with fries", "Cartofi pai (200 gr.)": "French fries", "Clătită cu banană/fructe de pădure/vișină/ si mascarpone (180 gr.)": "Pancake with banana/berries/cherry and mascarpone", "Clătită cu banană și nuttela (150gr)": "Pancake with banana and Nutella", "Lava-cake de ciocolată (100/30gr)": "Chocolate lava cake", "Înghetată în asortiment (Betty-Ice) (3 bile)": "Assorted ice cream (3 scoops)",
                Espresso: "Espresso", "Espresso cu lapte": "Espresso with milk", "Espresso Dublu": "Double Espresso", Americano: "Americano", "Americano cu lapte": "Americano with milk", Cappuccino: "Cappuccino", "Caffe latte": "Caffe latte", "Ice latte": "Ice latte", "Ciocolată cu lapte": "Hot Chocolate", "Ceai Aloe Vera (400 ml)": "Aloe Vera Tea (400 ml)", "Ceai de cătină (400 ml)": "Sea Buckthorn Tea (400 ml)", "Ceai Fructul pasiunii (400ml)": "Passion Fruit Tea (400ml)", "Ceai de zmeură": "Raspberry Tea", "Ceai în asortiment": "Assorted Tea", "Ceai în asortiment infuzie (400 ml)": "Assorted Loose Leaf Tea (400 ml)", "Fresh de portocală (300ml)": "Orange fresh", "Coca cola (250 ml)":"Coca-Cola (250 ml)", "Coca cola zero (250ml)":"Coca-Cola Zero (250ml)", "Sprite (250ml)":"Sprite (250ml)", "Fanta (250 ml)":"Fanta (250 ml)", "Vita (250 ml)":"Vita Juice (250 ml)", "plată/gazată (330ml)": "Still/sparkling water (330ml)", "plată/gazată (750ml)": "Still/sparkling water (750ml)", "Corona (350 ml)": "Corona (350 ml)", "Grolsh (350 ml)": "Grolsch (350 ml)", "Franziskaner (500 ml) (naturtrub)": "Franziskaner (unfiltered)", Chips: "Chips", Alune: "Peanuts", "Lemongrass": "Lemongrass", "Raspberry Lemonade": "Raspberry Lemonade", "Apple& Aloe Vera Twist": "Apple & Aloe Vera Twist", "Maracuja lemonade": "Passion Fruit Lemonade", "Mojito lemonade": "Mojito Lemonade", "Aperol Spritz": "Aperol Spritz", "Watermelon & Lychee Spritz": "Watermelon & Lychee Spritz", "Grapefruit & Lychee Spritz": "Grapefruit & Lychee Spritz", Margarita: "Margarita", "Mojito alcoholic": "Mojito", "Chery Flower": "Cherry Flower", "Jameson (40ml)":"Jameson (40ml)", "Jameson (700ml)": "Jameson (bottle)", "Jack Daniels (40ml)":"Jack Daniels (40ml)", "Jack Daniels (700ml)": "Jack Daniels (bottle)", "Bardar 5 ani (40ml)":"Bardar 5 years (40ml)", "Bardar 5 ani (500ml)": "Bardar 5 years (bottle)", "Bardar Silver 7 ani (40ml)":"Bardar Silver 7 years (40ml)", "Bardar Silver 7 ani (500ml)": "Bardar Silver 7 years (bottle)", "Bardar Gold 7 ani (40ml)":"Bardar Gold 7 years (40ml)", "Bardar Gold 7 ani (500ml)": "Bardar Gold 7 years (bottle)", "Bardar 10 ani (40ml)":"Bardar 10 years (40ml)", "Bardar 10 ani (500ml)": "Bardar 10 years (bottle)", "Bardar 12 ani (500ml)": "Bardar 12 years (bottle)"
            }
        },
        ro: {
            menu_title: "Gust Rafinat", menu_subtitle: "Cele mai bune vinuri și bucătărie de autor", our_menu: "Meniul Nostru", food_btn: "Mâncare", drinks_btn: "Băuturi", rights: "© 2025 Feliz Wine Bar.", add_to_cart_btn: "Adaugă în coș", cart_title: "Coș", cart_total: "Total:", checkout_btn: "Finalizează comanda", checkout_title: "Finalizare comandă", confirm_order: "Confirmă comanda", name_placeholder: "Numele dvs.", phone_placeholder: "Telefon de contact", address_placeholder: "Adresa de livrare", login_title: "Autentificare", register_title: "Înregistrare", email_placeholder: "Email", password_placeholder: "Parola", login_btn: "Intră", register_btn: "Înregistrează-te", no_account: "Nu aveți cont?", have_account: "Aveți deja un cont?", switch_to_register: "Înregistrare", switch_to_login: "Autentificare", admin_panel: "Panou Admin", profile: "Profil", logout: "Ieșire", login: "Autentificare", register: "Înregistrare", cart: "Coș", admin: "Admin", loading_menu: "Se încarcă meniul...", empty_menu: "Deocamdată nu există poziții în această categorie.", loading_error: "Eroare la încărcarea meniului.", item_added: "a fost adăugat în coș", item_removed: "Produsul a fost șters", empty_cart: "Coșul dvs. este gol", order_placed: "Comanda a fost plasată cu succes!",
            categories: { Завтрак: "Micul dejun", Закуски: "Gustări", Салаты: "Salate", Супы: "Supe", "Морепродукты и Рыба": "Fructe de mare și Pește", Паста: "Paste", "Мясные блюда": "Mâncăruri din carne", "Бургеры и другое": "Burgeri și altele", Десерты: "Deserturi", Кофе: "Cafea", Чай: "Ceai", "Соки и Вода": "Sucuri și Apă", "Пиво и закуски": "Bere și Gustări", "Безалкогольные коктейли": "Cocktailuri non-alcoolice", "Алкогольные коктейли": "Cocktailuri alcoolice", Виски: "Whisky", Коньяк: "Divin", Игристые: "Spumante", "Белые вина": "Vinuri albe", "Розовые вина": "Vinuri rosé", "Красные вина": "Vinuri roșii" },
            products: {}
        }
    };

    function applyTranslations(a){document.querySelectorAll("[data-translate]").forEach(b=>{const c=b.getAttribute("data-translate"),d=translations[a]?.[c];d&&(b.placeholder?b.placeholder=d:b.textContent=d)})}function getTranslatedCategory(a,b){return translations[b]?.categories?.[a]||a}function getTranslatedProduct(a,b){return"ro"===b?a:translations[b]?.products?.[a]||a}function setLanguage(a){currentLanguage=a,localStorage.setItem("language",a),applyTranslations(a),document.querySelectorAll(".language-switcher").forEach(b=>{b.classList.toggle("active",b.dataset.lang===a)}),renderMenu()}function toggleModal(a){const b=document.getElementById(a);b&&b.classList.toggle("hidden");const c=!document.getElementById("auth-modal").classList.contains("hidden")||!document.getElementById("product-modal").classList.contains("hidden")||!document.getElementById("checkout-modal").classList.contains("hidden");document.body.style.overflow=c?"hidden":"auto"}
    
    // ИЗМЕНЕНА ФУНКЦИЯ
    function toggleProductModal(a = null) {
        const b = document.getElementById("product-modal"), 
              c = document.getElementById("product-modal-content"),
              d = !b.classList.contains("hidden");
        
        if (d) {
            c.classList.remove("active");
            setTimeout(() => {
                toggleModal("product-modal");
                currentProductInModal = null;
            }, 300);
        } else if (a) {
            currentProductInModal = { ...a, quantity: 1 };
            // ИЗМЕНЕНО: Устанавливаем src для тега <img> вместо background-image
            document.getElementById("product-modal-image").src = a.image_url || "https://placehold.co/400x400/1a1a1a/D4AF37?text=Feliz";
            document.getElementById("product-modal-name").textContent = a.name;
            document.getElementById("product-modal-description").textContent = a.description || "";
            document.getElementById("product-modal-price").textContent = `${a.price} MDL`;
            document.getElementById("product-modal-quantity").textContent = "1";
            toggleModal("product-modal");
            setTimeout(() => c.classList.add("active"), 10);
        }
    }

    function showToast(a,b=3e3){const c=document.getElementById("toast");c.textContent=a,c.style.display="block",c.classList.remove("hide"),setTimeout(()=>{c.classList.add("hide"),setTimeout(()=>{c.style.display="none"},500)},b)}function scrollCategories(a){document.getElementById("mobile-categories-scroll").scrollBy({left:a,behavior:"smooth"})}function updateScrollIndicators(){const a=document.getElementById("mobile-categories-scroll"),b=document.querySelector(".scroll-indicator.left"),c=document.querySelector(".scroll-indicator.right");if(!a||!b||!c)return;b.style.opacity=a.scrollLeft>10?"1":"0";const d=a.scrollWidth-a.clientWidth;c.style.opacity=a.scrollLeft<d-10?"1":"0"}
    function toggleMobileUserMenu(){const a=document.getElementById("mobile-user-menu"),b=document.getElementById("mobile-user-menu-overlay");a.classList.toggle("active"),b.classList.toggle("active"),document.body.style.overflow=a.classList.contains("active")?"hidden":"auto"}function switchAuthMode(){isLoginMode=!isLoginMode,document.getElementById("login-form").classList.toggle("hidden"),document.getElementById("register-form").classList.toggle("hidden"),applyTranslations(currentLanguage)}async function handleFormSubmit(a,b){try{const c=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(!c.ok||!d.success)throw new Error(d.message||"Unknown error");return d}catch(c){return{success:!1,message:c.message||"Network error"}}}
    function toggleCart(){const a=document.getElementById("cart-sidebar");a&&(a.classList.contains("translate-x-full"),a.classList.toggle("translate-x-full"),document.body.style.overflow=a.classList.contains("translate-x-full")?"auto":"hidden")}function openCheckoutModal(){cart.length>0&&(toggleCart(),setTimeout(()=>toggleModal("checkout-modal"),350))}
    function addToCart(a,b=1){const c={...a,name:currentProductInModal.originalName||a.name},d=cart.find(e=>e.id===c.id);d?d.quantity+=b:cart.push({...c,quantity:b});updateCart();showToast(`${a.name} (x${b}) ${translations[currentLanguage]?.item_added}`)}
    function changeQuantity(a,b){const c=cart.find(d=>d.id===a);c&&(c.quantity+=b,c.quantity<=0&&(cart=cart.filter(d=>d.id!==a),showToast(translations[currentLanguage]?.item_removed))),updateCart()}
    function updateCart(){const a=document.getElementById("cart-items"),b=document.getElementById("cart-count"),c=document.getElementById("mobile-cart-count"),d=document.getElementById("cart-total"),e=document.getElementById("checkout-button");if(!a||!b||!c||!d)return;if(a.innerHTML="",0===cart.length)a.innerHTML=`<p class="text-gray-400 text-center mt-8">${translations[currentLanguage]?.empty_cart}</p>`,e.disabled=!0,e.classList.add("opacity-50","cursor-not-allowed");else{e.disabled=!1,e.classList.remove("opacity-50","cursor-not-allowed");cart.forEach(f=>{const g=getTranslatedProduct(f.name,currentLanguage);a.innerHTML+=`<div class="flex items-center justify-between mb-4"><div><p class="font-semibold text-white">${g}</p><p class="text-sm text-gray-400">${f.price} MDL × ${f.quantity} = ${f.price*f.quantity} MDL</p></div><div class="flex items-center"><button onclick="changeQuantity('${f.id}', -1)" class="w-7 h-7 bg-gray-700 text-white rounded hover:bg-gray-600 transition">-</button><span class="w-8 text-center font-bold">${f.quantity}</span><button onclick="changeQuantity('${f.id}', 1)" class="w-7 h-7 bg-gray-700 text-white rounded hover:bg-gray-600 transition">+</button></div></div>`})}const f=cart.reduce((g,h)=>g+h.quantity,0);b.textContent=f,c.textContent=f,d.textContent=`${cart.reduce((g,h)=>g+h.price*h.quantity,0)} MDL`}
    async function renderMenu(){const a=document.getElementById("menu-content"),b=document.getElementById("mobile-categories-scroll"),c=translations[currentLanguage]?.loading_menu;categoryObserver&&categoryObserver.disconnect();try{a.innerHTML=`<div class="text-center py-8"><div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-brand-gold"></div><p class="mt-2 text-gray-400">${c}</p></div>`;const d=await fetch(`/api/get_menu?is_food=${currentFoodFilter}`);if(!d.ok)throw new Error(`HTTP error: ${d.status}`);const e=await d.json();if(a.innerHTML="",b.innerHTML="",0===e.length){a.innerHTML=`<p class="text-center text-gray-400 py-8">${translations[currentLanguage]?.empty_menu}</p>`;return}e.forEach((f,g)=>{const h=`category-section-${g}`,i=f.category.split("/")[0].trim(),j=getTranslatedCategory(i,currentLanguage),k=document.createElement("div");k.className="category-scroll-item",k.textContent=j,k.dataset.targetId=h,k.addEventListener("click",()=>{document.getElementById(h).scrollIntoView({behavior:"smooth",block:"start"})}),b.appendChild(k);let l="";f.items.forEach(m=>{const n=getTranslatedProduct(m.name,currentLanguage),o={...m,name:n,originalName:m.name};l+=`<div class="bg-[#2a2a2a] rounded-lg shadow-lg overflow-hidden cursor-pointer transform hover:-translate-y-1 transition-transform" onclick='toggleProductModal(${JSON.stringify(o)})'>
            <div class="product-card-image-wrapper">
                <img src="${m.image_url||"https://placehold.co/400x400/1a1a1a/D4AF37?text=Feliz"}" 
                     alt="${n}">
                <div class="product-price-overlay">
                    ${m.price} MDL
                </div>
            </div>
            <div class="product-card-name-wrapper">
                <h4 class="product-card-name">${n}</h4>
                <button class="product-card-add-btn"><i class="fas fa-plus"></i></button>
            </div>
        </div>`});const m=document.createElement("div");m.id=h,m.className="mb-12 scroll-mt-32",m.innerHTML=`<h3 class="text-3xl font-bold text-white mb-6 border-l-4 border-brand-gold pl-4">${j}</h3><div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">${l}</div>`,a.appendChild(m)}),document.querySelectorAll(".scroll-mt-32").forEach(f=>categoryObserver.observe(f)),updateScrollIndicators()}catch(d){console.error("Не удалось загрузить меню:",d),a.innerHTML=`<p class="text-red-500 text-center py-8">${translations[currentLanguage]?.loading_error}</p>`}}
    async function handleLogout(){try{const a=await fetch("/api/logout",{method:"POST"});a.ok?window.location.reload():showToast("Logout failed. Please try again.")}catch(a){showToast("Logout failed due to a network error.")}}
    document.addEventListener("DOMContentLoaded",()=>{categoryObserver=new IntersectionObserver(a=>{a.forEach(b=>{const c=document.querySelector(`.category-scroll-item[data-target-id="${b.target.id}"]`);b.isIntersecting&&c&&(document.querySelectorAll(".category-scroll-item").forEach(d=>d.classList.remove("active")),c.classList.add("active"))})},{rootMargin:"-90px 0px -60% 0px",threshold:0}),setLanguage(currentLanguage),updateCart(),document.getElementById("food-btn").addEventListener("click",()=>{1!==currentFoodFilter&&(currentFoodFilter=1,document.getElementById("food-btn").classList.add("active"),document.getElementById("drinks-btn").classList.remove("active"),renderMenu())}),document.getElementById("drinks-btn").addEventListener("click",()=>{0!==currentFoodFilter&&(currentFoodFilter=0,document.getElementById("drinks-btn").classList.add("active"),document.getElementById("food-btn").classList.remove("active"),renderMenu())}),document.getElementById("checkout-button")?.addEventListener("click",openCheckoutModal),document.getElementById("checkout-form-modal")?.addEventListener("submit",async a=>{a.preventDefault();const b=await handleFormSubmit("/api/place_order",{name:document.getElementById("checkout-name-modal").value,phone:document.getElementById("checkout-phone-modal").value,address:document.getElementById("checkout-address-modal").value,cart:cart});b.success?(toggleModal("checkout-modal"),cart=[],updateCart(),a.target.reset(),showToast(translations[currentLanguage]?.order_placed)):showToast(b.message)}),document.getElementById("mobile-user-menu-toggle")?.addEventListener("click",toggleMobileUserMenu),document.getElementById("mobile-user-menu-overlay")?.addEventListener("click",toggleMobileUserMenu),document.getElementById("mobile-cart-btn")?.addEventListener("click",toggleCart),document.getElementById("quantity-plus").addEventListener("click",()=>{currentProductInModal&&(currentProductInModal.quantity++,document.getElementById("product-modal-quantity").textContent=currentProductInModal.quantity)}),document.getElementById("quantity-minus").addEventListener("click",()=>{currentProductInModal&&currentProductInModal.quantity>1&&(currentProductInModal.quantity--,document.getElementById("product-modal-quantity").textContent=currentProductInModal.quantity)}),document.getElementById("modal-add-to-cart-btn").addEventListener("click",()=>{currentProductInModal&&(addToCart(currentProductInModal,currentProductInModal.quantity),toggleProductModal())}),document.getElementById("logout-button")?.addEventListener("click",handleLogout),document.getElementById("logout-button-mobile")?.addEventListener("click",handleLogout),document.getElementById("mobile-categories-scroll").addEventListener("scroll",updateScrollIndicators),window.addEventListener("resize",updateScrollIndicators),document.getElementById("login-form")?.addEventListener("submit",async a=>{a.preventDefault();const b=document.getElementById("login-email").value,c=document.getElementById("login-password").value,d=await handleFormSubmit("/api/login",{email:b,password:c});d.success?(toggleModal("auth-modal"),window.location.reload()):showToast(d.message||"Login failed. Please check your credentials.")}),document.getElementById("register-form")?.addEventListener("submit",async a=>{a.preventDefault();const b=await handleFormSubmit("/api/register",{name:document.getElementById("reg-name").value,email:document.getElementById("reg-email").value,phone:document.getElementById("reg-phone").value,password:document.getElementById("reg-password").value});b.success?(showToast("Registration successful! Please log in."),switchAuthMode()):showToast(b.message||"Registration failed.")})});
</script>
</body>
</html>